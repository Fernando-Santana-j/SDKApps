<link rel="stylesheet" href="/public/css/header.css">
<!-- Mobile Menu Button -->
<div id="header-menu" class="flex-center">
    <div class="hamburger">
        <span></span>
        <span></span>
        <span></span>
    </div>
</div>

<!-- Overlay when mobile menu is open -->
<div class="menu-overlay"></div>

<header id="header" class="main-header">
    <div id="header-container">
        <div id="sdk-logo-header-top">
            <a href="/" class="logo">SDKApps</a>
        </div> 

        <a href="/dashboard" id="header-up-content" data-tooltip="Clique para ir para o dashboard"
            data-tooltip-position="right" data-tooltip-title="<%= store.IDName %>">
            <div id="header-up-server">
                <div class="logo-glow"></div>
                <div id="header-up-server-pic" class="flex-center">
                    <img src="<%= store.style.logo %>" alt="<%= store.displayName %> Logo">
                </div>
                <p id="header-up-server-name">
                    <%= store.displayName %>
                </p>
            </div>
        </a>

        <!-- Navigation Menu -->
        <nav id="header-nav-content">
            <ul id="header-nav-list">
                <a href="/console/<%= store.id %>" class="header-nav-list-link <%= index == 1 ? 'menuActive' : '' %>">
                    <li class="header-nav-list-item">
                        <div class="list-item-icon flex-center">
                            <svg class="SvgFill" version="1.1" xmlns="http://www.w3.org/2000/svg"
                                xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0,0,256,256">
                                <g fill="#ffffff" fill-rule="nonzero" stroke="none" stroke-width="1"
                                    stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10"
                                    stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none"
                                    font-size="none" text-anchor="none" style="mix-blend-mode: normal">
                                    <g transform="scale(10.66667,10.66667)">
                                        <path
                                            d="M4,2c-1.09306,0 -2,0.90694 -2,2v7c0,1.09306 0.90694,2 2,2h5c1.09306,0 2,-0.90694 2,-2v-7c0,-1.09306 -0.90694,-2 -2,-2zM15,2c-1.09306,0 -2,0.90694 -2,2v3c0,1.09306 0.90694,2 2,2h5c1.09306,0 2,-0.90694 2,-2v-3c0,-1.09306 -0.90694,-2 -2,-2zM4,4h5v7h-5zM15,4h5v3h-5zM15,11c-1.09306,0 -2,0.90694 -2,2v7c0,1.09306 0.90694,2 2,2h5c1.09306,0 2,-0.90694 2,-2v-7c0,-1.09306 -0.90694,-2 -2,-2zM15,13h5v7h-5zM4,15c-1.09306,0 -2,0.90694 -2,2v3c0,1.09306 0.90694,2 2,2h5c1.09306,0 2,-0.90694 2,-2v-3c0,-1.09306 -0.90694,-2 -2,-2zM4,17h5v3h-5z">
                                        </path>
                                    </g>
                                </g>
                            </svg>
                        </div>
                        <div class="list-item-name">
                            Painel
                        </div>
                    </li>
                </a>
                <a href="/console/sales/<%= store.id %>"
                    class="header-nav-list-link <%= index == 2 ? 'menuActive' : '' %>">
                    <li class="header-nav-list-item">
                        <div class="list-item-icon flex-center">
                            <svg class="SvgFillStroke SvgNoFill" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 16v5"/><path d="M16 14v7"/><path d="M20 10v11"/><path d="m22 3-8.646 8.646a.5.5 0 0 1-.708 0L9.354 8.354a.5.5 0 0 0-.707 0L2 15"/><path d="M4 18v3"/><path d="M8 14v7"/></svg>
                        </div>
                        <div class="list-item-name">
                            Vendas
                        </div>
                    </li>
                </a>
                <a href="/console/customize/<%= store.id %>" class="header-nav-list-link <%= index == 3 ? 'menuActive' : '' %>">
                    <li class="header-nav-list-item">
                        <div class="list-item-icon flex-center">
                            <svg class="SvgNoFill SvgFillStroke" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path class="SvgNoFill" d="M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z"/><path d="m15 5 3 3"/></svg>
                        </div>
                        <div class="list-item-name">
                            Customizar
                        </div>
                    </li>
                </a>
                <a href="/console/integrations/<%= store.id %>" class="header-nav-list-link <%= index == 4 ? 'menuActive' : '' %>">
                    <li class="header-nav-list-item">
                        <div class="list-item-icon flex-center">
                            <svg class="SvgNoFill SvgFillStroke" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><path d="M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z"/></svg>
                        </div>
                        <div class="list-item-name">
                            Integrações
                        </div>
                    </li>
                </a>
                <a href="/console/logs/<%= store.id %>" class="header-nav-list-link <%= index == 5 ? 'menuActive' : '' %>">
                    <li class="header-nav-list-item">
                        <div class="list-item-icon flex-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="SvgNoFill SvgFillStroke" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-notepad-text-icon lucide-notepad-text"><path d="M8 2v4"/><path d="M12 2v4"/><path d="M16 2v4"/><rect width="16" height="18" x="4" y="4" rx="2"/><path d="M8 10h6"/><path d="M8 14h8"/><path d="M8 18h5"/></svg>
                        </div>
                        <div class="list-item-name">
                            Logs
                        </div>
                    </li>
                </a>
            </ul>
        </nav>

        <div id="header-profile-container">
            <div id="header-profile-content" class="profile-dropdown">
                <div id="profile-pic" class="flex-center">
                    <img src="<%= user.profile_pic ? user.profile_pic : '/public/img/Logos/LOGO-PIXEL.gif' %>">
                </div>
                <p id="profile-display-name">
                    <%= user.username %>
                </p>
                <div class="dropdown-icon"><svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class=""><path d="m18 15-6-6-6 6"/></svg></div>

                <div class="dropdown-content">
                    <a href="/profile/<%= user.id %>">
                        <i class="fa-solid fa-user"></i> Perfil
                    </a>
                    <a href="/settings">
                        <i class="fa-solid fa-gear"></i> Configurações
                    </a>
                    <a href="/logout" class="logout-link">
                        <i class="fa-solid fa-sign-out-alt"></i> Sair
                    </a>
                </div>
            </div>
        </div>
    </div>
</header>

<script>
 document.addEventListener('DOMContentLoaded', function () {
  const menuBtn = document.getElementById('header-menu');
  const header = document.getElementById('header');
  const menuOverlay = document.querySelector('.menu-overlay');
  const hamburger = document.querySelector('.hamburger');
  menuBtn.addEventListener('click', function () {
      const isOpen = header.classList.toggle('open');
      hamburger.classList.toggle('active');
      menuOverlay.classList.toggle('active');
      gsap.to("#header", {
          duration: 0.5,
          left: isOpen ? 0 : -300,
          ease: "power3.out"
      });
  });
  menuOverlay.addEventListener('click', function () {
      header.classList.remove('open');
      hamburger.classList.remove('active');
      menuOverlay.classList.remove('active');
      gsap.to("#header", {
          duration: 0.5,
          left: -300,
          ease: "power3.in"
      });
  });

  const profileDropdown = document.getElementById('header-profile-content');
  const dropdownContent = document.querySelector('.dropdown-content');
  const dropdownIcon = document.querySelector('.dropdown-icon');

  const style = document.createElement('style');
  style.textContent = `
    .dropdown-content {
      overflow: hidden;
      clip-path: inset(0 0 0 0);
      position: relative;
    }
  `;
  document.head.appendChild(style);

  gsap.set(dropdownContent, { 
    height: 0, 
    opacity: 0, 
    display: 'none',
    clipPath: "inset(100% 0 0 0)"
  });

  profileDropdown.addEventListener('click', function () {
      const isVisible = dropdownContent.classList.toggle('visible');
      
      if (isVisible) {
          dropdownContent.style.display = 'block';
    
          const height = dropdownContent.scrollHeight;
          gsap.set(dropdownContent, { height: height, opacity: 0 });
          gsap.fromTo(dropdownContent,
              { clipPath: "inset(100% 0 0 0)", opacity: 0 },
              { 
                  clipPath: "inset(0 0 0 0)", 
                  opacity: 1, 
                  duration: 0.3, 
                  ease: "power3.out" 
              }
          );
      } else {
          gsap.to(dropdownContent, {
              clipPath: "inset(100% 0 0 0)",
              opacity: 0,
              duration: 0.3,
              ease: "power3.in",
              onComplete: () => {
                  setTimeout(() => {
                    dropdownContent.style.display = 'none';
                    gsap.set(dropdownContent, { height: 0 });
                  }, 200);
              }
          });
      }
      
      // Rotação do ícone do dropdown
      gsap.to(dropdownIcon, {
          duration: 0.3,
          rotation: isVisible ? 180 : 0,
          ease: "back.in(1.7)"
      });
  });

  const menuItems = document.querySelectorAll('.header-nav-list-link');
  menuItems.forEach(item => {
      item.addEventListener('mouseenter', function () {
          if (!item.classList.contains('menuActive')) {
              
              gsap.to(item.querySelector('.list-item-icon'), {
                  duration: 0.4,
                  rotation: 5,
                  scale: 1.1,
                  ease: "back.out(1.7)"
              });
          }
      });
      item.addEventListener('mouseleave', function () {
          if (!item.classList.contains('menuActive')) {
              gsap.to(item.querySelector('.list-item-icon'), {
                  duration: 0.4,
                  rotation: 0,
                  scale: 1,
                  ease: "back.out(1.7)"
              });
          }
      });
  });
});
</script>